{% extends "./master/layout.html" %}
{% block title %}Word to PDF - Compactify{% endblock %}
{% block head %} {{ super() }} {% endblock %}
{% block content %}

<script>
  function validateFile(file) {
    const allowedExtensions = ['docx', 'doc'];
    const filename = file.name.toLowerCase();
    const fileExtension = filename.substring(filename.lastIndexOf('.') + 1);
    console.log('Ekstensi file:', fileExtension);

    if (!allowedExtensions.includes(fileExtension)) {
      return false;
    }

    return true;
  }

  function handleFileChange(event) {
    const file = event.target.files[0];
    if (!file) return null;
    return validateFile(file);
  }

  function docToPdfConverter() {
    return {
      selectedFile: null,
      errorMessage: '',
      isDragOver: false,
      isProcessing: false,

      handleFileSelect(event) {
        const file = event.target.files[0];
        this.validateAndSetFile(file);
      },

      handleDrop(event) {
        this.isDragOver = false;
        const file = event.dataTransfer.files[0];
        this.validateAndSetFile(file);
      },

      validateAndSetFile(file) {
        if (!file) return;
        
        const allowedTypes = ['application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/msword'];
        const maxSize = 10 * 1024 * 1024; // 10MB
        
        if (!allowedTypes.includes(file.type) && !file.name.toLowerCase().endsWith('.doc') && !file.name.toLowerCase().endsWith('.docx')) {
          this.errorMessage = 'Please select a valid Word document (DOC, DOCX)';
          return;
        }
        
        if (file.size > maxSize) {
          this.errorMessage = 'File size must be less than 10MB';
          return;
        }
        
        this.selectedFile = file;
        this.errorMessage = '';
      },

      clearFile() {
        this.selectedFile = null;
        this.errorMessage = '';
        document.querySelector('input[type="file"]').value = '';
      },

      formatFileSize(bytes) {
        if (!bytes) return '';
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(1024));
        return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];
      },

      handleSubmit(event) {
        if (!this.selectedFile) {
          event.preventDefault();
          this.errorMessage = 'Please select a Word document first';
          return;
        }
        this.isProcessing = true;
      }
    }
  }
</script>  
<!-- Background with gradient -->
<div class="min-h-screen py-8 bg-gradient-to-br from-green-50 via-white to-teal-50">
  <div class="container px-4 mx-auto">
    <!-- Main Card -->
    <div class="max-w-2xl mx-auto">
      <div class="overflow-hidden bg-white border border-gray-100 shadow-2xl rounded-3xl">
        <!-- Header Section -->
        <div class="px-8 py-12 text-center bg-gradient-to-r from-green-600 to-teal-600">
          <div class="flex justify-center mb-6">
            <div class="p-4 rounded-full bg-white/20 backdrop-blur-sm">
              <img src="{{ url_for('static', filename='image/logo.png') }}" class="w-auto h-16" alt="Compactify Logo" />
            </div>
          </div>
          <h1 class="mb-2 text-3xl font-bold text-white">Word to PDF</h1>
          <p class="text-green-100">Convert your Word documents to PDF format</p>
        </div>
        
        <!-- Form Section -->
        <div class="p-8">
          <form x-data="docToPdfConverter()" @submit="handleSubmit($event)" action="{{ url_for('wordtopdf') }}" method="POST" enctype="multipart/form-data">
            
            <!-- File Upload Area -->
            <div class="mb-8">
              <div 
                class="relative p-8 text-center transition-all duration-200 border-2 border-gray-300 border-dashed rounded-2xl hover:border-green-400 hover:bg-green-50/50"
                :class="{ 'border-green-500 bg-green-50': isDragOver, 'border-blue-500 bg-blue-50': selectedFile }"
                @dragover.prevent="isDragOver = true"
                @dragleave.prevent="isDragOver = false"
                @drop.prevent="handleDrop($event)"
              >
                
                <!-- Default State -->
                <div x-show="!selectedFile" class="space-y-4">
                  <div class="flex items-center justify-center w-20 h-20 mx-auto bg-green-100 rounded-full">
                    <i class="text-3xl text-green-600 fas fa-file-word"></i>
                  </div>
                  <div>
                    <h3 class="mb-2 text-xl font-semibold text-gray-800">Drop your Word document here</h3>
                    <p class="mb-4 text-gray-500">or click to browse files</p>
                    <p class="text-sm text-gray-400">Supports: DOC, DOCX (Max: 10MB)</p>
                  </div>
                </div>
                
                <!-- Selected File Preview -->
                <div x-show="selectedFile" class="space-y-4">
                  <div class="flex items-center justify-center w-16 h-16 mx-auto bg-blue-100 rounded-full">
                    <i class="text-2xl text-blue-600 fas fa-check"></i>
                  </div>
                  <div>
                    <p class="text-lg font-semibold text-gray-800" x-text="selectedFile?.name"></p>
                    <p class="text-gray-500" x-text="formatFileSize(selectedFile?.size)"></p>
                  </div>
                  <button 
                    type="button" 
                    @click="clearFile()"
                    class="font-medium text-red-600 transition-colors duration-200 hover:text-red-700"
                  >
                    <i class="mr-1 fas fa-times"></i>Remove file
                  </button>
                </div>
                
                <input 
                  type="file" 
                  name="file" 
                  accept=".doc,.docx"
                  @change="handleFileSelect($event)"
                  class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                />
              </div>
              
              <!-- Error Message -->
              <div x-show="errorMessage" class="p-4 mt-4 border border-red-200 rounded-lg bg-red-50">
                <div class="flex items-center">
                  <i class="mr-2 text-red-600 fas fa-exclamation-triangle"></i>
                  <p class="font-medium text-red-700" x-text="errorMessage"></p>
                </div>
              </div>
            </div>

            <!-- Conversion Options -->
            <div class="mb-8" x-show="selectedFile">
              <label class="block mb-4 text-lg font-semibold text-gray-800">
                <i class="mr-2 text-green-600 fas fa-cogs"></i>
                PDF Settings
              </label>
              <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
                <div class="p-4 border-2 border-green-200 rounded-xl bg-green-50">
                  <div class="text-center">
                    <div class="flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-green-100 rounded-full">
                      <i class="text-green-600 fas fa-file-pdf"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800">Standard PDF</h4>
                    <p class="text-sm text-gray-600">High quality PDF conversion</p>
                  </div>
                </div>
                
                <div class="p-4 border-2 border-gray-200 rounded-xl">
                  <div class="text-center">
                    <div class="flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full">
                      <i class="text-gray-600 fas fa-lock"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800">Protected PDF</h4>
                    <p class="text-sm text-gray-600">Coming soon</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <div class="flex justify-center">
              <button 
                type="submit" 
                :disabled="!selectedFile || isProcessing"
                class="px-8 py-4 font-semibold text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-teal-600 rounded-xl hover:shadow-lg hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100"
              >
                <span x-show="!isProcessing" class="flex items-center">
                  <i class="mr-2 fas fa-exchange-alt"></i>
                  Convert to PDF
                </span>
                <span x-show="isProcessing" class="flex items-center">
                  <div class="w-5 h-5 mr-2 border-2 border-white rounded-full animate-spin border-t-transparent"></div>
                  Converting...
                </span>
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Features Section -->
      <div class="grid grid-cols-1 gap-6 mt-12 md:grid-cols-3">
        <div class="p-6 text-center bg-white border border-gray-100 shadow-lg rounded-2xl">
          <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full">
            <i class="text-2xl text-green-600 fas fa-magic"></i>
          </div>
          <h3 class="mb-2 text-lg font-semibold text-gray-800">Perfect Formatting</h3>
          <p class="text-gray-600">Maintains original document layout and formatting</p>
        </div>
        
        <div class="p-6 text-center bg-white border border-gray-100 shadow-lg rounded-2xl">
          <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full">
            <i class="text-2xl text-blue-600 fas fa-shield-alt"></i>
          </div>
          <h3 class="mb-2 text-lg font-semibold text-gray-800">100% Secure</h3>
          <p class="text-gray-600">Your documents are processed securely and deleted automatically</p>
        </div>
        
        <div class="p-6 text-center bg-white border border-gray-100 shadow-lg rounded-2xl">
          <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-teal-100 rounded-full">
            <i class="text-2xl text-teal-600 fas fa-bolt"></i>
          </div>
          <h3 class="mb-2 text-lg font-semibold text-gray-800">Lightning Fast</h3>
          <p class="text-gray-600">Quick conversion without compromising quality</p>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}  